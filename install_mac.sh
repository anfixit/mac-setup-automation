#!/bin/bash
LOGFILE="install_log.txt"
exec > >(tee -a "$LOGFILE") 2>&1

echo "üöÄ –ù–∞—á–∞–ª–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –ø—Ä–æ–≥—Ä–∞–º–º..."

# ==============================
# 1Ô∏è‚É£ –ó–∞–ø—Ä–æ—Å –ø–∞—Ä–æ–ª—è sudo –≤ –Ω–∞—á–∞–ª–µ (—á—Ç–æ–±—ã –Ω–µ –≤–≤–æ–¥–∏—Ç—å –µ–≥–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ)
# ==============================
echo "üîë –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (sudo), —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É..."
sudo -v

# –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º —Å–µ—Å—Å–∏—é sudo –∞–∫—Ç–∏–≤–Ω–æ–π, –ø–æ–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç
while true; do sudo -v; sleep 60; done &

# ==============================
# 2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è VPN –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π
# ==============================
echo "üî¥ –ü–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –æ—Ç–∫–ª—é—á–∏—Ç–µ VPN –∏ –Ω–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..."
read -r  # –ñ–¥—ë–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

VPN_STATUS=$(scutil --nc list | grep -i 'connected')

if [[ -n "$VPN_STATUS" ]]; then
    echo "‚ö†Ô∏è  VPN –≤—Å—ë –µ—â—ë –≤–∫–ª—é—á—ë–Ω! –û—Ç–∫–ª—é—á–∏—Ç–µ VPN –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞."
    exit 1  # –ó–∞–≤–µ—Ä—à–∞–µ–º —Å–∫—Ä–∏–ø—Ç, –µ—Å–ª–∏ VPN –Ω–µ –æ—Ç–∫–ª—é—á—ë–Ω
fi

echo "‚úÖ VPN –æ—Ç–∫–ª—é—á—ë–Ω. –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —É—Å—Ç–∞–Ω–æ–≤–∫—É..."

# ==============================
# 3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
# ==============================
echo "üåç –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É..."
if ! ping -c 1 8.8.8.8 &> /dev/null; then
    echo "‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞."
    exit 1
fi
echo "‚úÖ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω."

# ==============================
# 4Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Homebrew (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
# ==============================
if ! command -v brew &>/dev/null; then
    echo "üì¶ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Homebrew..."
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    echo 'eval "$(/opt/homebrew/bin/brew shellenv)"' >> ~/.zprofile
    eval "$(/opt/homebrew/bin/brew shellenv)"
else
    echo "‚úÖ Homebrew —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω."
fi

brew update && brew upgrade

# ==============================
# 5Ô∏è‚É£ –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
# ==============================
is_installed() {
    local app_name="$1"
    if [[ -d "/Applications/$app_name.app" ]]; then
        echo "‚úÖ $app_name —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º."
        return 0
    else
        return 1
    fi
}

# ==============================
# 6Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
# ==============================
echo "üõ†Ô∏è –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏..."

brew install --cask pycharm-ce
brew install --cask iterm2
brew install --cask visual-studio-code
brew install --cask sublime-text
brew install --cask postman

# ==============================
# 7Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ñ–∏—Å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
# ==============================
echo "üìë –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ñ–∏—Å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è..."
brew install --cask onlyoffice

# ==============================
# 8Ô∏è‚É£ –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Å–∏—Å—Ç–µ–º—ã
# ==============================
echo "‚öôÔ∏è –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã..."
brew install --cask keka
brew install --cask appcleaner
brew install --cask onyx
brew install --cask daisydisk
brew install --cask hiddenbar
brew install --cask force-paste  # –ó–∞–º–µ–Ω–µ–Ω–æ –≤–º–µ—Å—Ç–æ pure-paste
brew install --cask cheatsheet
brew install --cask lulu
brew install --cask macs-fan-control
brew install --cask rocket
brew install --cask raycast
brew install --cask shottr
brew install --cask keepingyouawake  # –ó–∞–º–µ–Ω–µ–Ω–æ –≤–º–µ—Å—Ç–æ amphetamine
brew install --cask karabiner-elements

# ==============================
# 9Ô∏è‚É£ –û–±—Ä–∞–±–æ—Ç–∫–∞ –º—É–ª—å—Ç–∏–º–µ–¥–∏–∞
# ==============================
echo "üé• –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º—É–ª—å—Ç–∏–º–µ–¥–∏–π–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è..."
brew install --cask imageoptim
brew install --cask vlc
brew install --cask iina
brew install --cask obs

# ==============================
# üîü –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã, –æ–±–ª–∞—á–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, –±—Ä–∞—É–∑–µ—Ä—ã)
# ==============================
echo "üì° –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è..."
brew install --cask telegram
brew install --cask cyberduck
brew install --cask dropbox
brew install --cask folx
brew install --cask yandex

# ==============================
# üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø–∞—Ä–æ–ª–∏
# ==============================
echo "üîê –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–µ–Ω–µ–¥–∂–µ—Ä—ã –ø–∞—Ä–æ–ª–µ–π –∏ –±–ª–æ–∫–∏—Ä–æ–≤—â–∏–∫–∏..."
brew install --cask bitwarden
brew install --cask adguard

# ==============================
# üìÖ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
# ==============================
echo "üìÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏..."
brew install --cask obsidian
brew install --cask notion
brew install --cask dash
brew install --cask pomodone

# ==============================
# üê≥ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker (—Ç—Ä–µ–±—É–µ—Ç sudo)
# ==============================
echo "üê≥ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Docker..."
if is_installed "Docker"; then
    echo "‚úÖ Docker —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω."
else
    brew install --cask docker
fi

# ==============================
# üñ¥ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ NTFS-3G –∏ macFUSE (—Ç—Ä–µ–±—É–µ—Ç sudo)
# ==============================
echo "üñ¥ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º NTFS-3G –∏ macFUSE..."
brew install ntfs-3g
brew install --cask macfuse
sudo mkdir -p /Volumes/NTFS

# ==============================
# üîÑ –û—á–∏—Å—Ç–∫–∞ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
# ==============================
echo "üßπ –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤..."
brew cleanup

echo "‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –ü—Ä–æ–≤–µ—Ä—å $LOGFILE –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫."
